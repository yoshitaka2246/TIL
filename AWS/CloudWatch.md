# Amazon CloudWatch
Amazon CloudWatchはAWSリソースやアプリケーションを監視するための管理システムです。
主に次の３つの機能があります。CloudWatchはAWSのほぼすべてのサービスと連携しており、
「パフォーマンス監視」「異常検知」「コスト管理」などに使えます。
## 主な機能
### メトリクス (Metrics)
リソースの状態や性能を数値として監視する機能で、EC2のCPU仕様率、Lambdaの実行回数、S3のリクエスト数などを表示することができます。
### ログ(logs)
アプリやシステムが出力するログを収集・検索する機能で、アプリケーションログ、OSログ、Lambdaログなどを確認することができます。
### アラーム(alarms)
メトリクスの閾値を監視し、超えたら通知や自動アクションを実行する機能です。CPU仕様率が一定割合を超えたら通知したり、課金額が一定超過したらメール通知などを送る機能があります。

## 請求額アラームの設定
例として、ある一定額を超えたら自動でメール通知を送る設定をする方法を紹介します。`Billing`はus-east-1（バージニア北部）リージョン専用のため、リージョンを`米国（バージニア北部）`に切り替えてから設定しましょう。請求額はグローバルで集計されるため、S3のリージョン設定などが日本のものになっていても大丈夫です。

1. 請求情報メトリクスの有効化
   1. AWSコンソールへ移動→`右上の自分のユーザーネーム`→`Billing(請求)`→`Billing preferences(請求設定)`　見つからない場合は[ここ](https://console.aws.amazon.com/billing/home)をクリック。
   2. `CloudWatch請求アラート`をオンにする。 
  デフォルトでは請求情報がAmazon CloudWatchに反映されないため、上記の設定をすることで請求情報がCloudWatchに送信されるようになります。
2. CloudWatchアラームを作成
   1. CloudWatchコンソールへ移動→左側の`アラーム`から→`すべてのアラーム`→`アラームの作成`をクリック
   2. `メトリクスの選択`→`Billing`→`概算合計請求額(EstimatedCharges)`
   3. 通貨を選択し、`メトリクスの選択`をクリック
   4. 「統計」で`最大値`を選択し、「条件」を設定する
   5. 「アクションの設定」で、「次の SNS トピックに通知を送信」内の`新しいトピックの作成`を選択して新しいSNSのを設定する。
   6. 通知内容を自分で作成し、`アラームの作成`
