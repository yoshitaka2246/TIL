# Amazon API gatewayについて
本記事では、Amazon API gatewayについて説明します。API gatewayとは、AWSが提供する「APIの作成および管理を簡単に行える」フルマネージドサービスです。Lambda や EC2、DynamoDB、S3 などと連携することが可能です。

```css
[Client]
   ↓  (HTTPリクエスト)
[API Gateway]
   ↓  (トリガー)
[Lambda Function]
   ↓  (レスポンス)
API Gateway → Client に返す
```
## APIの４つの種類
AWS API Gatewayは、異なるケースに対応するため、4種類のAPIタイプを提供しています。これらは大きく**HTTP通信**と**双方向通信**にわけられます。
### 1.REST API
これはAPI Gatewayで最も歴史があり、機能が充実している**旧来のタイプ**です。
|特徴|説明|
|--------------|-------------------------------------------------|
|通信方式|クライアントが要求し、サーバーが応答する形式の<br>**リクエスト・レスポンス型の単方向通信**|
|統合方式|**Lambdaプロキシ統合**と**非プロキシ統合**の両方に対応。|
|主要な機能|WAFとの統合、APIキー、使用量プラン、キャッシュ、カスタムドメインなど。|
|実務での用途|複雑なデータ変換が必要なAPI、より高度なセキュリティやマネタイズ機能が必要なパブリックAPI|
|エンドポイント|**エッジ最適化**(CloudFront利用)、**リージョン**、**プライベート**の3タイプを選択可能|

### 2.HTTP API
REST APIに比べて**シンプルさ、高速性、低コスト**を追求した、新しいタイプのAPIです。**今から新しくAPIを構築するなら、このHTTP APIだけで十分です。**
|特徴|説明|
|--------------|-------------------------------------------------|
|通信方式|**リクエスト・レスポンス型の単方向通信**|
|統合方式|**Lambda**、**HTTPエンドポイント**、**AWSサービス**へのプロキシ統合に特化|
|主要な機能|**JWTオーソライザーによる認証**、カスタムドメイン|
|実務での用途|**高速でシンプルなAPI**。多くのモダンなマイクロサービスやサーバーレスAPIで採用される|
|エンドポイント|**パブリック**と**プライベート**の2タイプを選択可能|

### 3.WebSocket API
WebSocket APIは、従来のHTTP通信では実現できなかった**サーバー側からクライアントへデータをプッシュする双方向通信**を可能にするAPIです。
|特徴|説明|
|--------------|-------------------------------------------------|
|通信方式|**双方向通信**。一度接続を確立すると、切断されるまで両方向でデータを送り合える。|
|イベント駆動|`$connect`(接続時)、`$disconnect`(切断時)、`$default`(メッセージ受信時)という特定のイベントをLambdaに連携させることができる。|
|実務での用途|リアルタイムな機能。**チャットアプリ**、ライブスポーツの**スコア更新**、**IoTデバイスからの継続的なデータストリーム**|
|エンドポイント|パブリックアクセスのみ|
### 4.REST API(プライベートエンドポイント)
これはAPIのタイプと言うよりも、**REST API**が持つエンドポイントの接続設定の一つです。Amazon VPC(virtual Private Cloud)内からのみのアクセスを可能にし、外部からのアクセスを完全にブロックします。社内システム専用APIや、VPC内にホストされたWebサイトからのみアクセスを許可したいバックエンドAPIに用いられます。**高いセキュリティが求められる環境で必須**のサービスです。